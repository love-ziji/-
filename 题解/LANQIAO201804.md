---
title: 蓝桥杯 2018年第九届省赛 C/C++ B组 04 测试次数
date: 2021-04-11 14:04:36
tags:
- 动态规划
- 数学
categories:
- 蓝桥杯
cover: https://cdn.jsdelivr.net/gh/love-ziji/CDN/post5.jpg
mathjax: true
---

## 题目描述

x 星球的居民脾气不太好，但好在他们生气的时候唯一的异常举动是：摔手机。
各大厂商也就纷纷推出各种耐摔型手机。x 星球的质监局规定了手机必须经过耐摔测试，并且评定出一个耐摔指数来，之后才允许上市流通。
x 星球有很多高耸入云的高塔，刚好可以用来做耐摔测试。塔的每一层高度都是一样的，与地球上稍有不同的是，他们的第一层不是地面，而是相当于我们的 2 楼。
如果手机从第 7 层扔下去没摔坏，但第 8 层摔坏了，则手机耐摔指数 = 7。
特别地，如果手机从第1层扔下去就坏了，则耐摔指数 = 0。
如果到了塔的最高层第 n 层扔没摔坏，则耐摔指数 = n。
为了减少测试次数，从每个厂家抽样 3 部手机参加测试。
某次测试的塔高为 1000 层，如果我们总是采用最佳策略，在最坏的运气下最多需要测试多少次才能确定手机的耐摔指数呢？
请填写这个最多测试次数。

## 题目分析

### 动态规划

总是采用最佳策略，在最坏的运气下的最多测试次数是什么意思？即摔坏了所有手机且测试到最后一次才能测出耐摔指数所需要的最少测试次数。
我们先假设这个测试次数为 k，n 部手机 m 层楼，既然有 k 次机会，我们不妨从第 k 层开始测试，若第 1 部手机摔坏了，那么接下来测试 n - 1 部手机 1 \~ k - 1 层的情况；若没有摔坏，就测试 n 部手机 k + 1 \~ m 层的情况（测试时只关心层数，所以 1 \~ m - k 等价于 k + 1 \~ m），即从 k + (k - 1) 层开始测试，若第 1 部手机这次摔坏了，那么接下来测试 n - 1 部手机 k + 1 \~ k + (k - 1) - 1 层的情况；若这次也没有摔坏，就测试 n 部手机 k + (k - 1) + 1 \~ m 层楼的情况，以此类推。
综上所述，设$dp[i][j]$表示 i 部手机 j 层楼的测试次数，则状态转移方程为:
$dp[i][j]=max(dp[i-1][k-1],dp[i][j-k])+1,1<=k<=j-1$
dp数组初始化时，初始化为最坏情况，即 j 层楼测试 j 次，则状态转移方程变化为:
$dp[i][j]=min(dp[i][j],max(dp[i-1][k-1],dp[i][j-k])+1),1<=k<=j-1$

```c++
#include<iostream>
using namespace std;

int main()
{
	int phone=3,floor=1000,dp[4][1001];
	for(int i=1;i<=phone;i++) {
		for(int j=1;j<=floor;j++) {
			dp[i][j]=j; //初始化为最坏情况 
		}
	}
	for(int i=2;i<=phone;i++) {
		for(int j=1;j<=floor;j++) {
			for(int k=1;k<j;k++) {
				dp[i][j]=min(dp[i][j],max(dp[i-1][k-1],dp[i][j-k])+1); //状态转移方程 
			}
		}
	}
	cout<<dp[3][1000]<<endl;
	
	return 0;
}
```

### 数学推导

将问题转换为：n 部手机 k 次测试最多可以测出多少层楼。
先分析 n = 2 的情况，同上第 1 部手机从第 k 层开始测试，既然要求最多可以测出多少层楼，那么手机应没有摔坏，从k+(k-1)层开始测试，以此类推，最多可以测出的层数为：
$k+(k-1)+(k-2)+\cdots+2+1=\frac{k(k+1)}{2}$
再分析 n = 3 的情况，由上可知 2 部手机 k - 1 测试最多可以测出$\frac{k(k-1)}{2}$层楼，所以第1部手机从$\frac{k(k-1)}{2}+1$层开始测试，同上既然要求最多可以测出多少层楼，那么手机应没有摔坏，从$\frac{k(k-1)}{2}+1+\frac{(k-1)(k-2)}{2}+1$层开始测试，以此类推，最多可以测出的层数为：
$[\frac{k(k-1)}{2}+1]+[\frac{(k-1)(k-2)}{2}+1]+\cdots+[\frac{2\times1}{2}+1]+[\frac{1\times0}{2}+1]$
$=\frac{1}{2}\lbrace[k^2+(k-1)^2+\cdots+1]-[k+(k-1)+\cdots+1]\rbrace+k$
$=\frac{1}{2}[\frac{k(k+1)(2k+1)}{6}-\frac{k(k+1)}{2}]+k$
$=\frac{k^3+5k}{6}$
能测出的最多楼层大于等于题目给出的 1000 就能求出测试次数 k：
$\frac{k^3+5k}{6}\geq1000$

```c++
#include<iostream>
#include<cmath>
using namespace std;

int main()
{
	int k=1;
	while(pow(k,3)+5*k < 6000) {
		k++;
	}
	cout<<k<<endl;
	
	return 0;
}
```

## 题目答案

**19**